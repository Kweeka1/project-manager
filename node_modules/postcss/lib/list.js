'use strict'

let list = ***REMOVED***
  split(string, separators, last) ***REMOVED***
    let array = []
    let current = ''
    let split = false

    let func = 0
    let quote = false
    let escape = false

    for (let letter of string) ***REMOVED***
      if (escape) ***REMOVED***
        escape = false
  ***REMOVED*** else if (letter === '\\') ***REMOVED***
        escape = true
  ***REMOVED*** else if (quote) ***REMOVED***
        if (letter === quote) ***REMOVED***
          quote = false
    ***REMOVED***
  ***REMOVED*** else if (letter === '"' || letter === "'") ***REMOVED***
        quote = letter
  ***REMOVED*** else if (letter === '(') ***REMOVED***
        func += 1
  ***REMOVED*** else if (letter === ')') ***REMOVED***
        if (func > 0) func -= 1
  ***REMOVED*** else if (func === 0) ***REMOVED***
        if (separators.includes(letter)) split = true
  ***REMOVED***

      if (split) ***REMOVED***
        if (current !== '') array.push(current.trim())
        current = ''
        split = false
  ***REMOVED*** else ***REMOVED***
        current += letter
  ***REMOVED***
***REMOVED***

    if (last || current !== '') array.push(current.trim())
    return array
***REMOVED***

  space(string) ***REMOVED***
    let spaces = [' ', '\n', '\t']
    return list.split(string, spaces)
***REMOVED***

  comma(string) ***REMOVED***
    return list.split(string, [','], true)
***REMOVED***
***REMOVED***

module.exports = list
list.default = list
