let fs = require('fs/promises')
let ***REMOVED*** spawn ***REMOVED*** = require('child_process')
let path = require('path')
let root = process.cwd()

function npmInstall(cwd) ***REMOVED***
  return new Promise((resolve) => ***REMOVED***
    let childProcess = spawn('npm', ['install'], ***REMOVED*** cwd ***REMOVED***)
    childProcess.on('exit', resolve)
***REMOVED***)
***REMOVED***

async function install() ***REMOVED***
  let base = path.resolve(root, 'integrations')
  let ignoreFolders = ['node_modules']
  let integrations = (await fs.readdir(base, ***REMOVED*** withFileTypes: true ***REMOVED***))
    .filter((integration) => integration.isDirectory())
    .filter((integration) => !ignoreFolders.includes(integration.name))
    .map((folder) => path.resolve(base, folder.name))
    .concat([base])
    .map((integration) => npmInstall(integration))

  await Promise.all(integrations)
  console.log('Done!')
***REMOVED***

install()
