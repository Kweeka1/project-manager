import fs from 'fs'
import postcss from 'postcss'
import tailwind from '..'

function build(***REMOVED*** from, to, config ***REMOVED***) ***REMOVED***
  return new Promise((resolve, reject) => ***REMOVED***
    console.log(`Processing ./$***REMOVED***from***REMOVED***...`)

    fs.readFile(`./$***REMOVED***from***REMOVED***`, (err, css) => ***REMOVED***
      if (err) throw err

      return postcss([tailwind(config)])
        .process(css, ***REMOVED***
          from: undefined,
    ***REMOVED***)
        .then((result) => ***REMOVED***
          fs.writeFileSync(`./$***REMOVED***to***REMOVED***`, result.css)
          return result
    ***REMOVED***)
        .then(resolve)
        .catch((error) => ***REMOVED***
          console.log(error)
          reject()
    ***REMOVED***)
***REMOVED***)
***REMOVED***)
***REMOVED***

console.info('\nRebuilding fixtures...\n')

Promise.all([
  build(***REMOVED***
    from: 'tests/fixtures/tailwind-input.css',
    to: 'tests/fixtures/tailwind-output.css',
    config: ***REMOVED******REMOVED***,
***REMOVED***),
  build(***REMOVED***
    from: 'tests/fixtures/tailwind-input.css',
    to: 'tests/fixtures/tailwind-output-important.css',
    config: ***REMOVED*** important: true ***REMOVED***,
***REMOVED***),
  build(***REMOVED***
    from: 'tests/fixtures/tailwind-input.css',
    to: 'tests/fixtures/tailwind-output-no-color-opacity.css',
    config: ***REMOVED***
      corePlugins: ***REMOVED***
        textOpacity: false,
        backgroundOpacity: false,
        borderOpacity: false,
        placeholderOpacity: false,
        divideOpacity: false,
  ***REMOVED***,
***REMOVED***,
***REMOVED***),
  build(***REMOVED***
    from: 'tests/fixtures/tailwind-input.css',
    to: 'tests/fixtures/tailwind-output-flagged.css',
    config: ***REMOVED***
      future: 'all',
      experimental: 'all',
***REMOVED***,
***REMOVED***),
]).then(() => ***REMOVED***
  console.log('\nFinished rebuilding fixtures.')
  console.log(
    '\nPlease triple check that the fixture output matches what you expect before committing this change.'
  )
***REMOVED***)
