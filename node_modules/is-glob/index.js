/*!
 * is-glob <https://github.com/jonschlinkert/is-glob>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */

var isExtglob = require('is-extglob');
var chars = ***REMOVED*** '***REMOVED***': '***REMOVED***', '(': ')', '[': ']'***REMOVED***;
var strictCheck = function(str) ***REMOVED***
  if (str[0] === '!') ***REMOVED***
    return true;
***REMOVED***
  var index = 0;
  var pipeIndex = -2;
  var closeSquareIndex = -2;
  var closeCurlyIndex = -2;
  var closeParenIndex = -2;
  var backSlashIndex = -2;
  while (index < str.length) ***REMOVED***
    if (str[index] === '*') ***REMOVED***
      return true;
***REMOVED***

    if (str[index + 1] === '?' && /[\].+)]/.test(str[index])) ***REMOVED***
      return true;
***REMOVED***

    if (closeSquareIndex !== -1 && str[index] === '[' && str[index + 1] !== ']') ***REMOVED***
      if (closeSquareIndex < index) ***REMOVED***
        closeSquareIndex = str.indexOf(']', index);
  ***REMOVED***
      if (closeSquareIndex > index) ***REMOVED***
        if (backSlashIndex === -1 || backSlashIndex > closeSquareIndex) ***REMOVED***
          return true;
    ***REMOVED***
        backSlashIndex = str.indexOf('\\', index);
        if (backSlashIndex === -1 || backSlashIndex > closeSquareIndex) ***REMOVED***
          return true;
    ***REMOVED***
  ***REMOVED***
***REMOVED***

    if (closeCurlyIndex !== -1 && str[index] === '***REMOVED***' && str[index + 1] !== '***REMOVED***') ***REMOVED***
      closeCurlyIndex = str.indexOf('***REMOVED***', index);
      if (closeCurlyIndex > index) ***REMOVED***
        backSlashIndex = str.indexOf('\\', index);
        if (backSlashIndex === -1 || backSlashIndex > closeCurlyIndex) ***REMOVED***
          return true;
    ***REMOVED***
  ***REMOVED***
***REMOVED***

    if (closeParenIndex !== -1 && str[index] === '(' && str[index + 1] === '?' && /[:!=]/.test(str[index + 2]) && str[index + 3] !== ')') ***REMOVED***
      closeParenIndex = str.indexOf(')', index);
      if (closeParenIndex > index) ***REMOVED***
        backSlashIndex = str.indexOf('\\', index);
        if (backSlashIndex === -1 || backSlashIndex > closeParenIndex) ***REMOVED***
          return true;
    ***REMOVED***
  ***REMOVED***
***REMOVED***

    if (pipeIndex !== -1 && str[index] === '(' && str[index + 1] !== '|') ***REMOVED***
      if (pipeIndex < index) ***REMOVED***
        pipeIndex = str.indexOf('|', index);
  ***REMOVED***
      if (pipeIndex !== -1 && str[pipeIndex + 1] !== ')') ***REMOVED***
        closeParenIndex = str.indexOf(')', pipeIndex);
        if (closeParenIndex > pipeIndex) ***REMOVED***
          backSlashIndex = str.indexOf('\\', pipeIndex);
          if (backSlashIndex === -1 || backSlashIndex > closeParenIndex) ***REMOVED***
            return true;
      ***REMOVED***
    ***REMOVED***
  ***REMOVED***
***REMOVED***

    if (str[index] === '\\') ***REMOVED***
      var open = str[index + 1];
      index += 2;
      var close = chars[open];

      if (close) ***REMOVED***
        var n = str.indexOf(close, index);
        if (n !== -1) ***REMOVED***
          index = n + 1;
    ***REMOVED***
  ***REMOVED***

      if (str[index] === '!') ***REMOVED***
        return true;
  ***REMOVED***
***REMOVED*** else ***REMOVED***
      index++;
***REMOVED***
***REMOVED***
  return false;
***REMOVED***;

var relaxedCheck = function(str) ***REMOVED***
  if (str[0] === '!') ***REMOVED***
    return true;
***REMOVED***
  var index = 0;
  while (index < str.length) ***REMOVED***
    if (/[*?***REMOVED******REMOVED***()[\]]/.test(str[index])) ***REMOVED***
      return true;
***REMOVED***

    if (str[index] === '\\') ***REMOVED***
      var open = str[index + 1];
      index += 2;
      var close = chars[open];

      if (close) ***REMOVED***
        var n = str.indexOf(close, index);
        if (n !== -1) ***REMOVED***
          index = n + 1;
    ***REMOVED***
  ***REMOVED***

      if (str[index] === '!') ***REMOVED***
        return true;
  ***REMOVED***
***REMOVED*** else ***REMOVED***
      index++;
***REMOVED***
***REMOVED***
  return false;
***REMOVED***;

module.exports = function isGlob(str, options) ***REMOVED***
  if (typeof str !== 'string' || str === '') ***REMOVED***
    return false;
***REMOVED***

  if (isExtglob(str)) ***REMOVED***
    return true;
***REMOVED***

  var check = strictCheck;

  // optionally relax check
  if (options && options.strict === false) ***REMOVED***
    check = relaxedCheck;
***REMOVED***

  return check(str);
***REMOVED***;
