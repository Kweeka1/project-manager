'use strict'

const u = require('universalify').fromCallback
const fs = require('graceful-fs')
const path = require('path')
const mkdir = require('../mkdirs')
const pathExists = require('../path-exists').pathExists

function outputFile (file, data, encoding, callback) ***REMOVED***
  if (typeof encoding === 'function') ***REMOVED***
    callback = encoding
    encoding = 'utf8'
***REMOVED***

  const dir = path.dirname(file)
  pathExists(dir, (err, itDoes) => ***REMOVED***
    if (err) return callback(err)
    if (itDoes) return fs.writeFile(file, data, encoding, callback)

    mkdir.mkdirs(dir, err => ***REMOVED***
      if (err) return callback(err)

      fs.writeFile(file, data, encoding, callback)
***REMOVED***)
***REMOVED***)
***REMOVED***

function outputFileSync (file, ...args) ***REMOVED***
  const dir = path.dirname(file)
  if (fs.existsSync(dir)) ***REMOVED***
    return fs.writeFileSync(file, ...args)
***REMOVED***
  mkdir.mkdirsSync(dir)
  fs.writeFileSync(file, ...args)
***REMOVED***

module.exports = ***REMOVED***
  outputFile: u(outputFile),
  outputFileSync
***REMOVED***
