"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true ***REMOVED***);
const stream_1 = require("../readers/stream");
const provider_1 = require("./provider");
class ProviderAsync extends provider_1.default ***REMOVED***
    constructor() ***REMOVED***
        super(...arguments);
        this._reader = new stream_1.default(this._settings);
***REMOVED***
    read(task) ***REMOVED***
        const root = this._getRootDirectory(task);
        const options = this._getReaderOptions(task);
        const entries = [];
        return new Promise((resolve, reject) => ***REMOVED***
            const stream = this.api(root, task, options);
            stream.once('error', reject);
            stream.on('data', (entry) => entries.push(options.transform(entry)));
            stream.once('end', () => resolve(entries));
    ***REMOVED***);
***REMOVED***
    api(root, task, options) ***REMOVED***
        if (task.dynamic) ***REMOVED***
            return this._reader.dynamic(root, options);
    ***REMOVED***
        return this._reader.static(task.patterns, options);
***REMOVED***
***REMOVED***
exports.default = ProviderAsync;
