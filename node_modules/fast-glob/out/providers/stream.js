"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true ***REMOVED***);
const stream_1 = require("stream");
const stream_2 = require("../readers/stream");
const provider_1 = require("./provider");
class ProviderStream extends provider_1.default ***REMOVED***
    constructor() ***REMOVED***
        super(...arguments);
        this._reader = new stream_2.default(this._settings);
***REMOVED***
    read(task) ***REMOVED***
        const root = this._getRootDirectory(task);
        const options = this._getReaderOptions(task);
        const source = this.api(root, task, options);
        const destination = new stream_1.Readable(***REMOVED*** objectMode: true, read: () => ***REMOVED*** ***REMOVED*** ***REMOVED***);
        source
            .once('error', (error) => destination.emit('error', error))
            .on('data', (entry) => destination.emit('data', options.transform(entry)))
            .once('end', () => destination.emit('end'));
        destination
            .once('close', () => source.destroy());
        return destination;
***REMOVED***
    api(root, task, options) ***REMOVED***
        if (task.dynamic) ***REMOVED***
            return this._reader.dynamic(root, options);
    ***REMOVED***
        return this._reader.static(task.patterns, options);
***REMOVED***
***REMOVED***
exports.default = ProviderStream;
