let Declaration = require('../declaration')
let utils = require('./grid-utils')

class GridRowColumn extends Declaration ***REMOVED***
  /**
   * Translate grid-row / grid-column to separate -ms- prefixed properties
   */
  insert(decl, prefix, prefixes) ***REMOVED***
    if (prefix !== '-ms-') return super.insert(decl, prefix, prefixes)

    let values = utils.parse(decl)
    let [start, span] = utils.translate(values, 0, 1)

    let hasStartValueSpan = values[0] && values[0].includes('span')

    if (hasStartValueSpan) ***REMOVED***
      span = values[0].join('').replace(/\D/g, '')
***REMOVED***

    ;[
      [decl.prop, start],
      [`$***REMOVED***decl.prop***REMOVED***-span`, span]
    ].forEach(([prop, value]) => ***REMOVED***
      utils.insertDecl(decl, prop, value)
***REMOVED***)

    return undefined
***REMOVED***
***REMOVED***

GridRowColumn.names = ['grid-row', 'grid-column']

module.exports = GridRowColumn
