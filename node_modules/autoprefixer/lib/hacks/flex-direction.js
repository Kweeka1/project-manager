let flexSpec = require('./flex-spec')
let Declaration = require('../declaration')

class FlexDirection extends Declaration ***REMOVED***
  /**
   * Return property name by final spec
   */
  normalize() ***REMOVED***
    return 'flex-direction'
***REMOVED***

  /**
   * Use two properties for 2009 spec
   */
  insert(decl, prefix, prefixes) ***REMOVED***
    let spec
    ;[spec, prefix] = flexSpec(prefix)
    if (spec !== 2009) ***REMOVED***
      return super.insert(decl, prefix, prefixes)
***REMOVED***
    let already = decl.parent.some(
      i =>
        i.prop === prefix + 'box-orient' || i.prop === prefix + 'box-direction'
    )
    if (already) ***REMOVED***
      return undefined
***REMOVED***

    let v = decl.value
    let orient, dir
    if (v === 'inherit' || v === 'initial' || v === 'unset') ***REMOVED***
      orient = v
      dir = v
***REMOVED*** else ***REMOVED***
      orient = v.includes('row') ? 'horizontal' : 'vertical'
      dir = v.includes('reverse') ? 'reverse' : 'normal'
***REMOVED***

    let cloned = this.clone(decl)
    cloned.prop = prefix + 'box-orient'
    cloned.value = orient
    if (this.needCascade(decl)) ***REMOVED***
      cloned.raws.before = this.calcBefore(prefixes, decl, prefix)
***REMOVED***
    decl.parent.insertBefore(decl, cloned)

    cloned = this.clone(decl)
    cloned.prop = prefix + 'box-direction'
    cloned.value = dir
    if (this.needCascade(decl)) ***REMOVED***
      cloned.raws.before = this.calcBefore(prefixes, decl, prefix)
***REMOVED***
    return decl.parent.insertBefore(decl, cloned)
***REMOVED***

  /**
   * Clean two properties for 2009 spec
   */
  old(prop, prefix) ***REMOVED***
    let spec
    ;[spec, prefix] = flexSpec(prefix)
    if (spec === 2009) ***REMOVED***
      return [prefix + 'box-orient', prefix + 'box-direction']
***REMOVED*** else ***REMOVED***
      return super.old(prop, prefix)
***REMOVED***
***REMOVED***
***REMOVED***

FlexDirection.names = ['flex-direction', 'box-direction', 'box-orient']

module.exports = FlexDirection
