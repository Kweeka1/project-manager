class OldSelector ***REMOVED***
  constructor(selector, prefix) ***REMOVED***
    this.prefix = prefix
    this.prefixed = selector.prefixed(this.prefix)
    this.regexp = selector.regexp(this.prefix)

    this.prefixeds = selector
      .possible()
      .map(x => [selector.prefixed(x), selector.regexp(x)])

    this.unprefixed = selector.name
    this.nameRegexp = selector.regexp()
***REMOVED***

  /**
   * Is rule a hack without unprefixed version bottom
   */
  isHack(rule) ***REMOVED***
    let index = rule.parent.index(rule) + 1
    let rules = rule.parent.nodes

    while (index < rules.length) ***REMOVED***
      let before = rules[index].selector
      if (!before) ***REMOVED***
        return true
  ***REMOVED***

      if (before.includes(this.unprefixed) && before.match(this.nameRegexp)) ***REMOVED***
        return false
  ***REMOVED***

      let some = false
      for (let [string, regexp] of this.prefixeds) ***REMOVED***
        if (before.includes(string) && before.match(regexp)) ***REMOVED***
          some = true
          break
    ***REMOVED***
  ***REMOVED***

      if (!some) ***REMOVED***
        return true
  ***REMOVED***

      index += 1
***REMOVED***

    return true
***REMOVED***

  /**
   * Does rule contain an unnecessary prefixed selector
   */
  check(rule) ***REMOVED***
    if (!rule.selector.includes(this.prefixed)) ***REMOVED***
      return false
***REMOVED***
    if (!rule.selector.match(this.regexp)) ***REMOVED***
      return false
***REMOVED***
    if (this.isHack(rule)) ***REMOVED***
      return false
***REMOVED***
    return true
***REMOVED***
***REMOVED***

module.exports = OldSelector
